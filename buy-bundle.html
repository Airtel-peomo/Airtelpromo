<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Buy Data Bundle</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      background: #f2f2f2;
    }
    header {
      background: red;
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 22px;
    }
    .container {
      padding: 20px;
    }
    input, select {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 16px;
    }
    .bundle-list {
      margin-top: 20px;
    }
    .bundle-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: white;
      padding: 10px 15px;
      border-radius: 10px;
      margin-bottom: 10px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .bundle-left {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .bundle-left img {
      width: 30px;
      height: 30px;
    }
    .buy-btn {
      background: red;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
    }
    .message {
      text-align: center;
      margin-top: 15px;
      font-weight: bold;
      color: green;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>

<header>Buy Data Bundle</header>

<div class="container">
  <label for="network">Select Network</label>
  <select id="network">
    <option value="Airtel">Airtel</option>
    <option value="MTN">MTN</option>
    <option value="Glo">Glo</option>
    <option value="9mobile">9mobile</option>
  </select>

  <label for="phone">Enter Phone Number</label>
  <input type="text" id="phone" placeholder="08012345678" maxlength="11" />

  <div class="bundle-list" id="bundleList"></div>

  <div class="message" id="message"></div>
</div>

<script>
  const bundles = {
    Airtel: [
      { price: 100, size: "500MB" },
      { price: 150, size: "700MB" },
      { price: 200, size: "1GB" },
    ],
    MTN: [
      { price: 150, size: "1GB" },
      { price: 250, size: "2GB" },
    ],
    Glo: [
      { price: 130, size: "1GB" },
      { price: 200, size: "2GB" },
    ],
    "9mobile": [
      { price: 120, size: "500MB" },
      { price: 180, size: "1GB" },
    ]
  };

  const logos = {
    Airtel: "https://upload.wikimedia.org/wikipedia/commons/6/6b/Airtel_logo_2022.svg",
    MTN: "https://upload.wikimedia.org/wikipedia/commons/2/2f/MTN_Logo.svg",
    Glo: "https://upload.wikimedia.org/wikipedia/commons/e/e1/Glo_Logo.svg",
    "9mobile": "https://upload.wikimedia.org/wikipedia/commons/1/19/9mobile_logo.png"
  };

  const networkSelect = document.getElementById("network");
  const bundleList = document.getElementById("bundleList");
  const messageBox = document.getElementById("message");

  let userBalance = parseInt(localStorage.getItem("userBalance")) || 0;
  const phoneInput = document.getElementById("phone");

  function updateBundles() {
    const network = networkSelect.value;
    bundleList.innerHTML = "";
    bundles[network].forEach(bundle => {
      const item = document.createElement("div");
      item.className = "bundle-item";
      item.innerHTML = `
        <div class="bundle-left">
          <img src="${logos[network]}" alt="${network}">
          <span>${bundle.size}</span>
        </div>
        <div>
          ₦${bundle.price}
          <button class="buy-btn" onclick="buyBundle('${network}', ${bundle.price}, '${bundle.size}')">Buy</button>
        </div>
      `;
      bundleList.appendChild(item);
    });
  }

  function buyBundle(network, price, size) {
    const phone = phoneInput.value.trim();
    messageBox.classList.remove("error");
    messageBox.innerText = "";

    if (phone.length !== 11 || !/^\d{11}$/.test(phone)) {
      messageBox.classList.add("error");
      messageBox.innerText = "Enter valid 11-digit phone number.";
      return;
    }

    if (userBalance < 3500) {
      messageBox.classList.add("error");
      messageBox.innerText = "Insufficient balance. You must fund at least ₦3,500.";
      return;
    }

    userBalance -= price;
    localStorage.setItem("userBalance", userBalance);

    // Save to history
    const history = JSON.parse(localStorage.getItem("transactionHistory") || "[]");
    history.push({
      type: "Data Bundle",
      network,
      amount: price,
      size,
      phone,
      time: new Date().toLocaleString()
    });
    localStorage.setItem("transactionHistory", JSON.stringify(history));

    messageBox.classList.remove("error");
    messageBox.innerHTML = `✅ <strong>Success:</strong> ${size} data purchased for ${phone} on ${network}.`;
  }

  networkSelect.addEventListener("change", updateBundles);

  // Load initial
  updateBundles();
</script>

</body>
  </html>
